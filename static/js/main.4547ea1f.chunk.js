(this["webpackJsonpecwid-test"]=this["webpackJsonpecwid-test"]||[]).push([[0],{26:function(t,e,n){},28:function(t,e,n){},29:function(t,e,n){},30:function(t,e,n){},31:function(t,e,n){},32:function(t,e,n){},33:function(t,e,n){},34:function(t,e,n){},35:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(7),o=n.n(c),i=n(4),s=n(14),l=n(5),d=n(3),u="ADD_NEW_ERROR",h="DELETE_ERROR",f="ADD_IMAGE",g="ADD_IMAGES_ARRAY",p="DELETE_IMAGE",y="SET_GALERY_WIDTH",b="SET_CALC_RESULT",j={galleryImages:[{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550746.jpg",width:640,height:426},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964007.jpg",width:1920,height:1200},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550739.jpg",width:640,height:426},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964009.jpg",width:436,height:650},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550740.jpg",width:600,height:400},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964008.jpg",width:509,height:339},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964011.jpg",width:900,height:450},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550755.jpg",width:480,height:640},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964013.jpg",width:472,height:640},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550745.jpg",width:640,height:425},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964014.jpg",width:240,height:320},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964016.jpg",width:540,height:337},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964020.jpg",width:1600,height:1e3},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964010.jpg",width:1506,height:575},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550754.jpg",width:1280,height:1276},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964021.jpg",width:1280,height:800},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964012.jpg",width:787,height:787}]},O=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case f:return Object(d.a)(Object(d.a)({},t),{},{galleryImages:[].concat(Object(l.a)(t.galleryImages),[e.payload])});case g:return Object(d.a)(Object(d.a)({},t),{},{galleryImages:[].concat(Object(l.a)(t.galleryImages),Object(l.a)(e.payload))});case p:var n=t.galleryImages.filter((function(t,n){return n!==e.payload}));return Object(d.a)(Object(d.a)({},t),{},{galleryImages:n});default:return t}},m={galeryWidth:window.innerWidth,cardsArr:[],rowsArr:[]},v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case y:return Object(d.a)(Object(d.a)({},t),{},{galeryWidth:e.payload});case b:return Object(d.a)(Object(d.a)({},t),e.payload);default:return t}},k={errors:[]},w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u:return Object(d.a)(Object(d.a)({},t),{},{errors:[].concat(Object(l.a)(t.errors),[e.payload])});case h:return Object(d.a)(Object(d.a)({},t),{},{errors:t.errors.filter((function(t){return t!==e.payload}))});default:return t}},x=Object(i.c)({galeryReducer:O,calcReducer:v,errorReducer:w}),A=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d)(Object(i.a)(s.a)),J=Object(i.e)(x,A),T=n(2),E=n(9),N=150,R=180,I=function(t){return function(e){var n=J.getState().calcReducer.galeryWidth;t!==n&&(e(function(t){return{type:y,payload:Math.ceil(t)}}(t)),e(S()))}},S=function(){var t=J.getState().galeryReducer.galleryImages,e=J.getState().calcReducer.galeryWidth,n=[],r=[],a=0,c=0;return t.forEach((function(t,o){var i=N/t.height*t.width;c+i>e?(a++,c=i):c+=i,n[o]={index:o,cardNormalWidth:i,rowNumber:a},r[a]=Math.ceil(c)})),{type:b,payload:{cardsArr:n,rowsArr:r}}},D=function(t){return function(e){e(function(t){return{type:u,payload:t}}(t)),setTimeout((function(){e(function(t){return{type:h,payload:t}}(t))}),2e3)}},_=function(t){return{type:f,payload:t}},L=function(t){return{type:g,payload:t}},P=function(t){return function(e){e(function(t){return{type:p,payload:t}}(t)),e(S())}},q=(n(26),n(1)),W=function(){var t=Object(r.useState)(["drop-field"]),e=Object(E.a)(t,2),n=e[0],a=e[1],c=Object(T.b)();return Object(q.jsx)("div",{className:n.join(" "),onDragEnter:function(t){t.preventDefault(),t.stopPropagation(),a(["drop-field","drop-field--drop-enter"])},onDragLeave:function(){a(["drop-field"])},onDragOver:function(t){t.preventDefault(),t.stopPropagation()},onDrop:function(t){var e;t.preventDefault(),t.stopPropagation(),c((e=t.dataTransfer.files,function(t){for(var n=0;n<e.length;n++){var r=e[n];r.type.startsWith("image/")?function(){var e=new Image,n=new FileReader;n.onload=function(){return e.src=n.result},n.readAsDataURL(r),e.onload=function(){t(_({url:e.src,height:e.height,width:e.width})),t(S())}}():"application/json"===r.type?r.text().then((function(t){return JSON.parse(t)})).then((function(e){e.galleryImages?(t(L(e.galleryImages)),t(S())):t(D('Not supported file data. Json file should contain "galleryImages" array'))})).catch((function(e){t(D("Error in json file parsing: ".concat(e)))})):t(D("".concat(r.name," - file type is not supported")))}})),a(["drop-field"])}})},X=function(t){return t.errorReducer.errors},V=(n(28),function(){var t=Object(T.c)(X);return Object(q.jsx)("div",{className:"error-message",children:!!t.length&&t.map((function(t){return Object(q.jsx)("div",{className:"error-message__text",children:t},t)}))})}),U=function(t){return t.calcReducer.galeryWidth},H=function(t){return t.calcReducer.cardsArr},M=function(t){return t.calcReducer.rowsArr},C=function(t){return t.galeryReducer.galleryImages},z=(n(29),function(){return Object(q.jsxs)("div",{className:"empty-galery",children:[Object(q.jsx)("h2",{children:"Galery is empty"}),Object(q.jsx)("p",{children:"Please enter url to image / json file or drop them here"})]})});n(30);var Q=function(t){var e=t.index,n=t.url,r=t.cardNormalWidth,a=t.rowScale,c=t.isLastRow,o=Object(T.b)(),i=c&&N*a>R?1.2*r:r*a,s=c&&N*a>R?R:N*a,l={width:i+"px",height:s+"px"};return Object(q.jsxs)("div",{style:l,className:"card",children:[Object(q.jsx)("img",{className:"card__image",src:n,alt:"img",width:i-6+"px",height:s-6+"px"}),Object(q.jsx)("button",{className:"card__delete-btn",onClick:function(){o(P(e))},children:Object(q.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXIAAAFyBAMAAAAaCkw6AAAAFVBMVEUAAADPz8/////q6up1dXUoKCiurq45ZD7wAAADH0lEQVR42u3bzU7bQBAAYCPhnEkMvbP83J2o9xbxACEtnAuCvv8jFHBScQAUhx2zId+cMkJKPo0mG89oqVIXx+MutietyMnJycnJycnJyd+SL5PJ8o/bk5KTk5OTk5OTk5O/KTdZkJOTk5OTk5OT2+W+k866mL6bFjhZXK8X5cnPqvViUZx8vqa8Lk2+bsn/F70Y+XxteV2WfP2SV/WiKPn6JV8VvRB5j5KvOr0Q+byXvC5H3q/kXacXIZ/2K3lX9BLkzVHVNxZlyNt5b3ldhHyDkj91+lC73KZ7RF2mJ7OXaf+SP9KbV9/qOW2zThaHl8/xt4v7yxfpQ7VJ/H7trbr0Z1b5QTVcXGWVHw0o39ta+dX2dkubUX6yvd3iG/q1+9zZ4mxxtnyFPg+ZND8Ui6yTBTk5OTk5OTk5+S7KzaGlTnPLLfQgkXcL/d7mP3ead/PvNhQ5OTk5Obl7udv2H39N086adnVJ+Ol1vjRW/u35RsRt96mz5QWJTOltpLz5EThR7Lfk5OTk5OTk5B/f5a7SUHnoZEFOTk5OTk5OTr5LcpMFOTk5OTk5OTm5Xa7JgpycnJycnJyc3C7XZEFOTk5OTk5OTm6XayYiJycnJycnJye3yyUnJycnJycnJye3yyUnJycnJycnJ7fLNVmQk5OTk5OTk5Pb5ZosyMnJycnJycnJ7XLNROTk5OTk5OTk5Ha5ZiJycnJycnJycnK7XHJycnJycvLdlf8JlI8i5eODQPneOFL+PVD+q6e83/P5aaD8InSyOA+UT0LlKVCeYuVxx+J+sDzuWBwFy8/C5ItgedxX9C5YnuZB8DpFy6MafS9cfhr4OxQrPwmST8PlQe0ySvHy08BmiZWH/IzupyHkEUW/2kDe7/n8Kdp5QMn7MzaQN4cBXT6IfJx9jh6lgeTjWd5+qaeDySd5n7vu0nDyrOfLRRpSns5zNUx9l4aVp+OHLPCbSRpa/mi/v/5oXN5O0yfIU5p1Md08bSefI//UlJx8J+T9H4wLScnJycnJycnJyckz7nJNFuTk5OTk5OTk5Ha5JgtycnJy8i8p/wfEnSO8+tiGOQAAAABJRU5ErkJggg==",height:"30px",width:"30px",alt:"Delete"})})]})};n(31);var Z=function(){var t=Object(T.c)(C),e=Object(T.c)(U),n=Object(T.c)(H),r=Object(T.c)(M);return Object(q.jsxs)("div",{className:"galery",children:[!n.length&&Object(q.jsx)(z,{}),!!n.length&&n.length===t.length&&t.map((function(t,a){return Object(q.jsx)(Q,{index:a,url:t.url,cardNormalWidth:n[a].cardNormalWidth,rowScale:e/r[n[a].rowNumber],isLastRow:n[a].rowNumber===r.length-1},t.url+a)}))]})};n(32);var B=function(t){return!!/^https?:\/\/.+\.(?:jpe?g|gif|png)$/gi.exec(t)},F=function(t){return!!/^https?:\/\/.+\.json$/gi.exec(t)},K=function(){var t=Object(r.useState)(""),e=Object(E.a)(t,2),n=e[0],a=e[1],c=Object(T.b)();return Object(q.jsx)("div",{className:"loader",children:Object(q.jsxs)("form",{className:"loader__form",onSubmit:function(t){var e,r;t.preventDefault(),""===n?c(D("Please enter image url or json file url")):B(n)?c((r=n,function(t){var e=new Image;e.src=r,e.onload=function(){t(_({url:r,height:e.height,width:e.width})),t(S())},e.onerror=function(){t(D("Error on image loading on url: ".concat(r)))}})):F(n)?c((e=n,function(t){fetch(e).then((function(t){if(!t.ok){var e=new Error;throw e.response=t,e}return t.text()})).then((function(e){if(""!==e){var n=JSON.parse(e);n.galleryImages?(t(L(n.galleryImages)),t(S())):t(D('Not supported file data. Json file should contain "galleryImages" array'))}else t(D('Emty file data. Json file should contain "galleryImages" array'))})).catch((function(e){t(D("Error in fetch: ".concat(e)))}))})):c(D("Not supported url. Please enter image url or json file url")),a("")},children:[Object(q.jsx)("input",{type:"text",placeholder:"Put here url to image or json file",className:"loader__form__input",onChange:function(t){a(t.target.value)},value:n}),Object(q.jsx)("button",{className:"loader__form__button",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]})})},G=(n(33),function(){var t=Object(T.b)(),e=Object(r.useRef)(null);return Object(r.useEffect)((function(){var n=function(){e.current&&t(I(e.current.clientWidth))};return n(),window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[t]),Object(q.jsxs)("div",{className:"app",ref:e,children:[Object(q.jsx)(V,{}),Object(q.jsx)(K,{}),Object(q.jsx)(Z,{}),Object(q.jsx)(W,{})]})});n(34);o.a.render(Object(q.jsx)(a.a.StrictMode,{children:Object(q.jsx)(T.a,{store:J,children:Object(q.jsx)(G,{})})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.4547ea1f.chunk.js.map