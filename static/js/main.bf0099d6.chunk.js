(this["webpackJsonpecwid-test"]=this["webpackJsonpecwid-test"]||[]).push([[0],{26:function(t,e,r){},28:function(t,e,r){},29:function(t,e,r){},30:function(t,e,r){},31:function(t,e,r){},32:function(t,e,r){},33:function(t,e,r){},34:function(t,e,r){},35:function(t,e,r){"use strict";r.r(e);var n=r(0),a=r.n(n),o=r(7),c=r.n(o),i=r(4),s=r(14),l=r(5),u=r(3),d="ADD_NEW_ERROR",h="DELETE_ERROR",f="ADD_IMAGE",g="ADD_IMAGES_ARRAY",p="DELETE_IMAGE",j="SET_GALERY_WIDTH",b="SET_CALC_RESULT",m={galleryImages:[{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550746.jpg",width:640,height:426},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964007.jpg",width:1920,height:1200},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550739.jpg",width:640,height:426},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964009.jpg",width:436,height:650},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550740.jpg",width:600,height:400},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964008.jpg",width:509,height:339},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964011.jpg",width:900,height:450},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550755.jpg",width:480,height:640},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964013.jpg",width:472,height:640},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550745.jpg",width:640,height:425},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964014.jpg",width:240,height:320},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964016.jpg",width:540,height:337},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964020.jpg",width:1600,height:1e3},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964010.jpg",width:1506,height:575},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/493550754.jpg",width:1280,height:1276},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964021.jpg",width:1280,height:800},{url:"https://don16obqbay2c.cloudfront.net/frontend-test-task/images/448964012.jpg",width:787,height:787}]},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case f:return Object(u.a)(Object(u.a)({},t),{},{galleryImages:[].concat(Object(l.a)(t.galleryImages),[e.payload])});case g:return Object(u.a)(Object(u.a)({},t),{},{galleryImages:[].concat(Object(l.a)(t.galleryImages),Object(l.a)(e.payload))});case p:var r=t.galleryImages.filter((function(t,r){return r!==e.payload}));return Object(u.a)(Object(u.a)({},t),{},{galleryImages:r});default:return t}},O={galeryWidth:window.innerWidth,cardsArr:[],rowsArr:[]},w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case j:return Object(u.a)(Object(u.a)({},t),{},{galeryWidth:e.payload});case b:return Object(u.a)(Object(u.a)({},t),e.payload);default:return t}},v={errors:[]},x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case d:return Object(u.a)(Object(u.a)({},t),{},{errors:[].concat(Object(l.a)(t.errors),[e.payload])});case h:return Object(u.a)(Object(u.a)({},t),{},{errors:t.errors.filter((function(t){return t!==e.payload}))});default:return t}},_=Object(i.c)({galeryReducer:y,calcReducer:w,errorReducer:x}),E=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d)(Object(i.a)(s.a)),N=Object(i.e)(_,E),R=r(2),I=r(9),k=150,D=180,S=function(t){return function(e){var r=N.getState().calcReducer.galeryWidth;t!==r&&(e(function(t){return{type:j,payload:Math.ceil(t)}}(t)),e(q()))}},q=function(){var t=N.getState().galeryReducer.galleryImages,e=N.getState().calcReducer.galeryWidth,r=[],n=[],a=0,o=0;return t.forEach((function(t,c){var i=k/t.height*t.width;o+i>e?(a++,o=i):o+=i,r[c]={index:c,cardNormalWidth:i,rowNumber:a},n[a]=Math.ceil(o)})),{type:b,payload:{cardsArr:r,rowsArr:n}}},A=function(t){return function(e){e(function(t){return{type:d,payload:t}}(t)),setTimeout((function(){e(function(t){return{type:h,payload:t}}(t))}),2e3)}},W=function(t){return{type:f,payload:t}},L=function(t){return{type:g,payload:t}},T=function(t){return function(e){e(function(t){return{type:p,payload:t}}(t)),e(q())}},P=(r(26),r(1)),J=function(){var t=Object(n.useState)(["drop-field"]),e=Object(I.a)(t,2),r=e[0],a=e[1],o=Object(R.b)();return Object(P.jsx)("div",{className:r.join(" "),onDragEnter:function(t){t.preventDefault(),t.stopPropagation(),a(["drop-field","drop-field--drop-enter"])},onDragLeave:function(){a(["drop-field"])},onDragOver:function(t){t.preventDefault(),t.stopPropagation()},onDrop:function(t){var e;t.preventDefault(),t.stopPropagation(),o((e=t.dataTransfer.files,function(t){for(var r=0;r<e.length;r++){var n=e[r];n.type.startsWith("image/")?function(){var e=new Image,r=new FileReader;r.onload=function(){return e.src=r.result},r.readAsDataURL(n),e.onload=function(){t(W({url:e.src,height:e.height,width:e.width})),t(q())}}():"application/json"===n.type?n.text().then((function(t){return JSON.parse(t)})).then((function(e){e.galleryImages?(t(L(e.galleryImages)),t(q())):t(A('Not supported file data. Json file should contain "galleryImages" array'))})).catch((function(e){t(A("Error in json file parsing: ".concat(e)))})):t(A("".concat(n.name," - file type is not supported")))}})),a(["drop-field"])}})},M=function(t){return t.errorReducer.errors},C=(r(28),function(){var t=Object(R.c)(M);return Object(P.jsx)("div",{className:"error-message",children:!!t.length&&t.map((function(t){return Object(P.jsx)("div",{className:"error-message__text",children:t},t)}))})}),G=function(t){return t.calcReducer.galeryWidth},U=function(t){return t.calcReducer.cardsArr},z=function(t){return t.calcReducer.rowsArr},X=function(t){return t.galeryReducer.galleryImages},Y=(r(29),function(){return Object(P.jsxs)("div",{className:"empty-galery",children:[Object(P.jsx)("h2",{children:"Galery is empty"}),Object(P.jsx)("p",{children:"Please enter url to image / json file or drop them here"})]})});r(30);var $=function(t){var e=t.index,r=t.url,n=t.cardNormalWidth,a=t.rowScale,o=t.isLastRow,c=Object(R.b)(),i=o&&k*a>D?1.2*n:n*a,s=o&&k*a>D?D:k*a,l={width:i+"px",height:s+"px"};return Object(P.jsxs)("div",{style:l,className:"card",children:[Object(P.jsx)("img",{className:"card__image",src:r,alt:"img",width:i-6+"px",height:s-6+"px"}),Object(P.jsx)("button",{className:"card__delete-btn",onClick:function(){c(T(e))}})]})};r(31);var B=function(){var t=Object(R.c)(X),e=Object(R.c)(G),r=Object(R.c)(U),n=Object(R.c)(z);return Object(P.jsxs)("div",{className:"galery",children:[!r.length&&Object(P.jsx)(Y,{}),!!r.length&&r.length===t.length&&t.map((function(t,a){return Object(P.jsx)($,{index:a,url:t.url,cardNormalWidth:r[a].cardNormalWidth,rowScale:e/n[r[a].rowNumber],isLastRow:r[a].rowNumber===n.length-1},t.url+a)}))]})};r(32);var F=function(t){return!!/^https?:\/\/.+\.(?:jpe?g|gif|png)$/gi.exec(t)},H=function(t){return!!/^https?:\/\/.+\.json$/gi.exec(t)},V=function(){var t=Object(n.useState)(""),e=Object(I.a)(t,2),r=e[0],a=e[1],o=Object(R.b)();return Object(P.jsx)("div",{className:"loader",children:Object(P.jsxs)("form",{className:"loader__form",onSubmit:function(t){var e,n;t.preventDefault(),""===r?o(A("Please enter image url or json file url")):F(r)?o((n=r,function(t){var e=new Image;e.src=n,e.onload=function(){t(W({url:n,height:e.height,width:e.width})),t(q())},e.onerror=function(){t(A("Error on image loading on url: ".concat(n)))}})):H(r)?o((e=r,function(t){fetch(e).then((function(t){if(!t.ok){var e=new Error;throw e.response=t,e}return t.text()})).then((function(e){if(""!==e){var r=JSON.parse(e);r.galleryImages?(t(L(r.galleryImages)),t(q())):t(A('Not supported file data. Json file should contain "galleryImages" array'))}else t(A('Emty file data. Json file should contain "galleryImages" array'))})).catch((function(e){t(A("Error in fetch: ".concat(e)))}))})):o(A("Not supported url. Please enter image url or json file url")),a("")},children:[Object(P.jsx)("input",{type:"text",placeholder:"Put here url to image or json file",className:"loader__form__input",onChange:function(t){a(t.target.value)},value:r}),Object(P.jsx)("button",{className:"loader__form__button",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]})})},K=(r(33),function(){var t=Object(R.b)(),e=Object(n.useRef)(null);return Object(n.useEffect)((function(){var r=function(){e.current&&t(S(e.current.clientWidth))};return r(),window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}}),[t]),Object(P.jsxs)("div",{className:"app",ref:e,children:[Object(P.jsx)(C,{}),Object(P.jsx)(V,{}),Object(P.jsx)(B,{}),Object(P.jsx)(J,{})]})});r(34);c.a.render(Object(P.jsx)(a.a.StrictMode,{children:Object(P.jsx)(R.a,{store:N,children:Object(P.jsx)(K,{})})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.bf0099d6.chunk.js.map